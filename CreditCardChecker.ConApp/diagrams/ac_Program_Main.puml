@startuml Program.Main
title Program.Main
start
#LightGreen:Params(string[] args);
#LightSkyBlue:string input, cardNumber = string.Empty\nint idx\nint sum = 0\nint digit, diff\nint evenSum = 0, oddSum = 0\nbool valid = true;
#WhiteSmoke:PrintLine("***************************************************");
#WhiteSmoke:PrintLine("* Kreditkarten-Prüfer                             *");
#WhiteSmoke:PrintLine("***************************************************");
#WhiteSmoke:PrintLine();
#WhiteSmoke:Print("Geben Sie Ihre 16-stellige Kreditkartennummer ein: ");
#WhiteSmoke:input = ReadLine();
#LightSkyBlue:int i = 0;
while (i < input.Length) is (<color:green>yes)
        if (char.IsWhiteSpace(input[i]) == false) then (<color:green>yes)
                #WhiteSmoke:cardNumber += input[i];
        endif
:i++;
endwhile (<color:red>no)
#WhiteSmoke:valid = cardNumber.Length == 16;
#WhiteSmoke:idx = 0;
while (valid && idx < cardNumber.Length) is (<color:green>yes)
        #WhiteSmoke:valid = char.IsDigit(cardNumber[idx++]);
endwhile (<color:red>no)
#WhiteSmoke:idx = 0;
while (valid && idx < cardNumber.Length - 1) is (<color:green>yes)
        #WhiteSmoke:digit = (cardNumber[idx] - '0') * 2;
        #WhiteSmoke:evenSum = digit > 9 ? evenSum + digit % 10 + (digit / 10 % 10)
                                    : evenSum + digit;
        #WhiteSmoke:idx = idx + 2;
endwhile (<color:red>no)
#WhiteSmoke:idx = 1;
while (valid && idx < cardNumber.Length - 1) is (<color:green>yes)
        #WhiteSmoke:oddSum = oddSum + (cardNumber[idx] - '0');
        #WhiteSmoke:idx = idx + 2;
endwhile (<color:red>no)
if (valid) then (<color:green>yes)
        #WhiteSmoke:sum = evenSum + oddSum;
        #WhiteSmoke:diff = (10 - sum % 10) % 10;
        #WhiteSmoke:valid = diff == cardNumber[cardNumber.Length - 1] - '0';
endif
#WhiteSmoke:PrintLine();
if (valid) then (<color:green>yes)
        #WhiteSmoke:PrintLine($"Die Kreditkartennummer '{input}' ist gültig.");
    else (<color:red>no)
            #WhiteSmoke:PrintLine($"Die Kreditkartennummer '{input}' ist ungültig.");
endif
#WhiteSmoke:PrintLine();
#WhiteSmoke:PrintLine("Press any key to exit: ");
#WhiteSmoke:ReadKey();
stop
@enduml
